package ex3.jdbc;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;


public class Ex03_MySql_Select {
	public static void main(String[] args) {
		Connection conn = null;
		Statement stmt = null;
		ResultSet rs = null;
		
		try{
				//1. ?“œ?¼?´ë²? ?“±ë¡?
			   Class.forName("com.mysql.jdbc.Driver"); //?“œ?¼?´ë²? ?´?˜?Š¤ ?´ë¦? ëª…ì‹œ 
			   System.out.println("My SQL ?“œ?¼?´ë²? ë¡œë“œ ?™„ë£?");
			   
			   //2. ?—°ê²°ìƒ?„±(ConnectionString)
			   conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/sampledb","sampleUser","1004");
			   
			   //3.ëª…ë ¹?ƒ?„± (CRUD)
			   stmt = conn.createStatement();
			   String sql = "select empno, ename , job  from emp where empno=1004";
			   
			   //4.ëª…ë ¹?‹¤?–‰(mysql ?—ê²? ëª…ë ¹ êµ¬ë¬¸ ?‹¤?–‰)
			    rs = stmt.executeQuery(sql);
			   
			   //5.ëª…ë ¹ì²˜ë¦¬
			   // ë°˜í™˜?œ row ê°? 1ê±? ?´?ƒ?¸ ê²½ìš°
			   // if(rs.next()){ do{}while(rs.next())}
			   //while(rs.next()){  
			   //   System.out.printf("[%d][%s][%s]\n", 
			   //			                 rs.getInt(1) , rs.getString(2) , rs.getString(3) );
			   //}
			   //***************ë°˜í™˜?œ row ê°? 1ê±´ì¸ ê²½ìš° ì²˜ë¦¬*****************************************
			    if(rs.next()){
			    	 System.out.printf("[%d][%s][%s]\n", 
			  			  			                 rs.getInt(1) , rs.getString(2) , rs.getString(3) );
			    }else{
			    	 System.out.println("ë°˜í™˜?œ ?–‰?´ ?—†?Šµ?‹ˆ?‹¤");
			    }
			
		}catch(Exception e){
			System.out.println(e.getMessage());
			
		}finally{
			//6.??›?•´? œ
			//DB?—°ê²? ì¢…ë£Œ
			if(rs != null){try{rs.close();}catch(Exception e){}}
			if(stmt != null){try{stmt.close();}catch(Exception e){}}
			if(conn != null){try{conn.close();}catch(Exception e){}}
		}
		
	}

}